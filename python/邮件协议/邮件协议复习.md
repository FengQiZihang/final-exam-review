# 邮件协议复习

## 协议概览

| 协议 | 中文名称 | 作用 | 默认端口 |
|------|----------|------|----------|
| SMTP | 简单邮件传输协议 | **发送**邮件 | 25 (明文) / 465 (SSL) / 587 (TLS) |
| POP3 | 邮局协议第3版 | **接收**邮件 | 110 (明文) / 995 (SSL) |

---

## SMTP 协议（发送邮件）

### 协议信息
- **中文名称**：简单邮件传输协议 (Simple Mail Transfer Protocol)
- **作用**：用于发送电子邮件
- **默认端口**：25（明文）、465（SSL）、587（TLS）

### Python 模块：`smtplib`

#### 主要函数

| 函数 | 说明 |
|------|------|
| `SMTP(host, port)` | 创建 SMTP 连接对象 |
| `SMTP_SSL(host, port)` | 创建 SSL 加密的 SMTP 连接 |
| `login(user, password)` | 登录邮箱服务器 |
| `sendmail(from_addr, to_addrs, msg)` | 发送邮件 |
| `quit()` | 关闭连接 |

#### 示例代码
```python
import smtplib
from email.mime.text import MIMEText

# 创建邮件内容
msg = MIMEText('邮件正文内容', 'plain', 'utf-8')
msg['Subject'] = '邮件标题'
msg['From'] = 'sender@example.com'
msg['To'] = 'receiver@example.com'

# 发送邮件
smtp = smtplib.SMTP_SSL('smtp.example.com', 465)
smtp.login('sender@example.com', 'password')
smtp.sendmail('sender@example.com', ['receiver@example.com'], msg.as_string())
smtp.quit()
```

---

## POP3 协议（接收邮件）

### 协议信息
- **中文名称**：邮局协议第3版 (Post Office Protocol 3)
- **作用**：用于从服务器接收/下载电子邮件
- **默认端口**：110（明文）、995（SSL）

### Python 模块：`poplib`

#### 主要函数

| 函数 | 说明 |
|------|------|
| `POP3(host, port)` | 创建 POP3 连接对象 |
| `POP3_SSL(host, port)` | 创建 SSL 加密的 POP3 连接 |
| `user(username)` | 设置用户名 |
| `pass_(password)` | 设置密码（注意下划线） |
| `stat()` | 获取邮箱统计信息（邮件数, 总大小） |
| `list()` | 列出所有邮件 |
| `retr(which)` | 获取指定邮件内容 |
| `dele(which)` | 删除指定邮件 |
| `quit()` | 关闭连接 |

#### 示例代码
```python
import poplib

# 连接服务器
pop = poplib.POP3_SSL('pop.example.com', 995)
pop.user('user@example.com')
pop.pass_('password')

# 获取邮件信息
count, size = pop.stat()
print(f'邮件数: {count}, 总大小: {size}')

# 获取第一封邮件
response, lines, octets = pop.retr(1)
msg_content = b'\r\n'.join(lines).decode('utf-8')

pop.quit()
```

---

## 协议对比

| 对比项 | SMTP | POP3 |
|--------|------|------|
| 功能 | 发送邮件 | 接收邮件 |
| Python 模块 | `smtplib` | `poplib` |
| 连接方式 | `SMTP()` / `SMTP_SSL()` | `POP3()` / `POP3_SSL()` |
| 登录方式 | `login(user, pwd)` | `user()` + `pass_()` |
| 关闭连接 | `quit()` | `quit()` |
